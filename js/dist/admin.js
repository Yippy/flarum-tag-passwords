(()=>{var t={n:r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return t.d(e,{a:e}),e},d:(r,e)=>{for(var o in e)t.o(e,o)&&!t.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:e[o]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};(()=>{"use strict";t.r(r);const e=flarum.core.compat["admin/app"];var o=t.n(e);const a=flarum.core.compat["common/extend"],s=flarum.core.compat["tags/models/Tag"];var n=t.n(s);const i=flarum.core.compat["common/Model"];var d=t.n(i);const p=flarum.core.compat["tags/components/EditTagModal"];var l=t.n(p);const c=flarum.core.compat["utils/Stream"];var u=t.n(c);const g=flarum.core.compat["common/helpers/icon"];var h=t.n(g);const f=flarum.core.compat["common/components/Button"];var _=t.n(f);const b=flarum.core.compat["common/components/Dropdown"];var w=t.n(b);const y=flarum.core.compat["common/models/Group"];var P=t.n(y);o().initializers.add("datlechin/flarum-tag-passwords",(function(){o().extensionData.for("datlechin-tag-passwords").registerSetting({setting:"flarum-tag-passwords.display_unlock_icon",label:o().translator.trans("datlechin-tag-passwords.admin.setting.display_unlock_icon"),type:"switch"}).registerSetting({setting:"flarum-tag-passwords.display_protected_tag_from_sidebar",label:o().translator.trans("datlechin-tag-passwords.admin.setting.display_protected_tag_from_sidebar"),type:"switch"}).registerSetting({setting:"flarum-tag-passwords.display_protected_tag_from_tags_page",label:o().translator.trans("datlechin-tag-passwords.admin.setting.display_protected_tag_from_tags_page"),type:"switch"}),n().prototype.isPasswordProtected=d().attribute("isPasswordProtected"),n().prototype.isGroupProtected=d().attribute("isGroupProtected"),n().prototype.password=d().attribute("password"),n().prototype.protectedGroups=d().attribute("protectedGroups"),(0,a.extend)(l().prototype,"oninit",(function(){this.isPasswordProtected=u()(this.tag.password()||!1),this.password=u()(this.tag.password()||""),this.isGroupProtected=u()(this.tag.protectedGroups()||!1),this.protectedGroups=this.tag.protectedGroups()?JSON.parse(this.tag.protectedGroups()):[]})),(0,a.extend)(l().prototype,"fields",(function(t){var r=this;t.add("protectedType",m("div",{className:"Form-group"},m("label",null,o().translator.trans("datlechin-tag-passwords.admin.edit_tag.protected_label")),m("div",null,m("label",{className:"checkbox"},m("input",{type:"checkbox",bidi:this.isPasswordProtected}),o().translator.trans("datlechin-tag-passwords.admin.edit_tag.password_protected_label")),m("label",{className:"checkbox"},m("input",{type:"checkbox",bidi:this.isGroupProtected}),o().translator.trans("datlechin-tag-passwords.admin.edit_tag.group_protected_label")),this.isPasswordProtected()&&!this.isGroupProtected()?m("input",{className:"FormControl",bidi:this.password,placeholder:o().translator.trans("datlechin-tag-passwords.admin.edit_tag.password_placeholder_label")}):"",this.isGroupProtected()&&!this.isPasswordProtected()?m("table",{className:"GroupListTable"},m("tbody",null,null===this.protectedGroups?m("tr",null,m("td",null,m(LoadingIndicator,null))):this.protectedGroups.map((function(t,e){return m("tr",null,m("td",null,o().store.all("groups").filter((function(r){return r.id()==t.id})).map((function(t){return t.namePlural()}))),m("td",null,m("button",{className:"Button Button--danger",onclick:function(t){t.preventDefault(),r.protectedGroups.splice(e,1),m.redraw()}},h()("fas fa-times"))))})),m("tr",null,m("td",{colspan:"5"},m(w(),{label:o().translator.trans("datlechin-tag-passwords.admin.edit_tag.select_group"),buttonClassName:"Button"},o().store.all("groups").filter((function(t){if(t.id()===P().MEMBER_ID||t.id()===P().GUEST_ID)return!1;var e=!1;return Array.isArray(r.protectedGroups)&&r.protectedGroups.forEach((function(r){r.id==t.id()&&(e=!0)})),!e})).map((function(t){return m(_(),{onclick:function(){r.protectedGroups.push({id:Number(t.id())}),m.redraw()}},t.namePlural())}))))))):"")))})),(0,a.extend)(l().prototype,"submitData",(function(t){t.password=this.isPasswordProtected()?this.password():null,t.protected_groups=this.isGroupProtected()&&this.protectedGroups.length>0?JSON.stringify(this.protectedGroups):null}))}))})(),module.exports=r})();
//# sourceMappingURL=admin.js.map